fade_out 0.7
bg null

say "char_name/none" "date/say_0"

generate_segment "date"
if date_location == 0
  bg3d "parque"
  date_location_name "location/park"
  play_music "date1_intro" "date1_loop"
endif
if date_location == 1
  bg3d "shopping"
  date_location_name "location/shopping"
  play_music "date2_intro" "date2_loop"
endif

set_var situation 2
set_var currentDateEvent 0
set_var date_success 0
set_var date_event_result_0 0
set_var date_event_result_1 0
set_var date_event_result_2 0
set_var date_event_result_3 0
set_var date_event_result_4 0
set_var date_event_result_5 0
set_var date_event_result_6 0

set_screen "date"

wait 0.5
show_date_ui true
fade_in 0.7

if tutorial_date == 0
  goto_script "tutorial_date"
endif


waypoint new_event
if currentDateEvent < #dateLength

waypoint start_interaction
set_screen "date_challenge"
wait 0.6
goto_script "\currentEventName" event_statement


if tutorial_date2 == 0
  goto_script "tutorial_date2"
endif


// wait for card input
card_input


wait 0.5
actor_anim3d
wait 2

event_resolution "date" selected_attribute

if resolution == 0
  goto_script "\currentEventName" guts_success
endif
if resolution == 1
  goto_script "\currentEventName" intelligence_success
endif
if resolution == 2
  goto_script "\currentEventName" charisma_success
endif
if resolution == 3
  goto_script "\currentEventName" guts_fail
endif
if resolution == 4
  goto_script "\currentEventName" intelligence_fail
endif
if resolution == 5
  goto_script "\currentEventName" charisma_fail
endif


add_var currentDateEvent 1
set_screen "date"
wait 0.5
if resolution < 3
  add_var date_success 1
  challenge_result true
  update_ui
  play_sfx "ui_success"
  wait 2
else
  challenge_result false
  update_ui
  play_sfx "ui_fail"
  wait 2
endif
goto new_event

endif


set_screen "date"

waypoint end
if date_success >= 5
  say "char_name/none" "date/say_4"
  show_date_ui false

  // set_screen "hide_all"
  fade_music 0 0.5
  show_engagement
  fade_music 1 1
  say "date/say_5"
  //set_screen "date"
  ship_couple
else
  say "char_name/none" "date/say_6"
  show_date_ui false
endif

goto_script "spend_day"

