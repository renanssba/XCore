set_people "date"
fade_out 0.7

say "" "\couple decidem sair para se divertir."

generate_segment "date"
if date_location == 0
  bg "park morning"
  play_music "date1_intro" "date1_loop"
endif
if date_location == 1
  bg "shopping"
  play_music "date2_intro" "date2_loop"
endif

set_var situation 2
set_var currentDateEvent 0
set_var date_success 0
set_var date_event_result_0 0
set_var date_event_result_1 0
set_var date_event_result_2 0
set_var date_event_result_3 0
set_var date_event_result_4 0
set_var date_event_result_5 0
set_var date_event_result_6 0

wait 0.5
show_date_ui true
fade_in 0.7

if tutorial_date == 0
  goto_script "tutorial_date"
endif


waypoint new_event
if #currentDateEvent < #dateLength

waypoint start_interaction
goto_script "\currentEventName" event_statement
set_people "event"



waypoint ac_interfere
// if #ap < 1
  // goto_script "not_enough_ap"
  // goto start_interaction
// endif

if tutorial_date2 == 0
  goto_script "tutorial_date2"
endif


if #currentEventInteractionType == 0
  say_auto "" "Qual atitude \boy deve tomar?"
endif
if #currentEventInteractionType == 1
  say_auto "" "Qual atitude \girl deve tomar?"
endif
if #currentEventInteractionType == 2
  say_auto "" "Qual atitude \couple devem tomar?"
endif


if #currentPersonality == 0
  choices "<color=#B27535><sprite='Attributes' index=0 tint>Valentia \guts</color>" sug_guts "<color=#248BCF><sprite='Attributes' index=1 tint>Inteligência \intelligence</color> (-1AP)" sug_intelligence "<color=#A80218><sprite='Attributes' index=2 tint>Carisma \charisma</color> (-1AP)" sug_charisma
endif
if #currentPersonality == 1
  choices "<color=#B27535><sprite='Attributes' index=0 tint>Valentia \guts</color> (-1AP)" sug_guts "<color=#248BCF><sprite='Attributes' index=1 tint>Inteligência \intelligence</color>" sug_intelligence "<color=#A80218><sprite='Attributes' index=2 tint>Carisma \charisma</color> (-1AP)" sug_charisma
endif
if #currentPersonality == 2
  choices "<color=#B27535><sprite='Attributes' index=0 tint>Valentia \guts</color> (-1AP)" sug_guts "<color=#248BCF><sprite='Attributes' index=1 tint>Inteligência \intelligence</color> (-1AP)" sug_intelligence "<color=#A80218><sprite='Attributes' index=2 tint>Carisma \charisma</color>" sug_charisma
endif

waypoint sug_guts
if #currentPersonality != 0
  if #ap < 1
    goto_script "not_enough_ap"
    goto start_interaction
  endif
  spend_ap 1
endif
set_var selected_attribute 0
goto ev_resolution

waypoint sug_intelligence
if #currentPersonality != 1
  if #ap < 1
    goto_script "not_enough_ap"
    goto start_interaction
  endif
  spend_ap 1
endif
set_var selected_attribute 1
goto ev_resolution

waypoint sug_charisma
if #currentPersonality != 2
  if #ap < 1
    goto_script "not_enough_ap"
    goto start_interaction
  endif
  spend_ap 1
endif
set_var selected_attribute 2
goto ev_resolution


waypoint ev_resolution
event_resolution "date" selected_attribute

Sif resolution == 0
  goto_script "\currentEventName" guts_success
endif
if resolution == 1
  goto_script "\currentEventName" intelligence_success
endif
if resolution == 2
  goto_script "\currentEventName" charisma_success
endif
if resolution == 3
  goto_script "\currentEventName" guts_fail
endif
if resolution == 4
  goto_script "\currentEventName" intelligence_fail
endif
if resolution == 5
  goto_script "\currentEventName" charisma_fail
endif

set_people "date"
if resolution < 3
  add_var date_success 1
  goto_script "set_event_result" "success"
  play_sfx "relationship_up"
  say "" "<color=green>Desafio superado!</color>"
else
  goto_script "set_event_result" "fail"
  play_sfx "relationship_down"
  say "" "<color=red>Desafio não superado.</color>"
endif
add_var currentDateEvent 1
update_ui
goto new_event

endif



waypoint end
if date_success >= 5
  say "O encontro acabou, e foi um <color=green>grande sucesso</color>!"
  show_date_ui false
  
  
  set_people "hide"
  wait 0.5
  show_engagement
  say "\couple se tornaram um casal inseparável, e você sabe que eles terão muitos filhos no futuro!"
  set_people "date"
  ship_couple
else
  say "O encontro acabou, e foi um <color=red>fracasso</color>!"
  show_date_ui false
endif


fade_out 0.5
bg null
update_ui
fade_in 0.5

if date_success >= 5
  say "Você passou a observar o seu próximo casal da lista: \couple."
endif

goto_script "spend_day"
set_people "show"

set_var situation 0
